{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 4, "column": 0}, "map": {"version":3,"sources":["file:///Users/abby/Desktop/UofTHacks26/frontend/app/lib/actions.tsx"],"sourcesContent":["'use server'\n\nimport { db } from '../../drizzle/index';\nimport { courses, submissions } from '../../drizzle/db/schema';\nimport { eq } from 'drizzle-orm';\nimport { revalidatePath } from 'next/cache';\n\n/**\n * COURSE MANAGEMENT\n */\nexport async function createCourse(formData: FormData) {\n    const name = formData.get('courseName') as string;\n    await db.insert(courses).values({\n        name: name,\n        description: \"Course initialized for audit.\",\n        currentGrade: 0,\n        milestones: [],\n    });\n    revalidatePath('/');\n}\n\nexport async function deleteCourse(courseId: string) {\n    try {\n        await db.delete(courses).where(eq(courses.id, courseId));\n        revalidatePath('/');\n        return { success: true };\n    } catch (error) {\n        return { success: false };\n    }\n}\n\n/**\n * SYLLABUS AUTOMATION (The Roadmap)\n * Aligned with SyllabusRequest in api.py\n */\nexport async function processSyllabusAction(courseId: string, publicUrl: string) {\n    try {\n        const backendBase = process.env.BACKEND_URL || \"http://127.0.0.1:8000\";\n\n        const response = await fetch(`${backendBase}/process-syllabus`, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({\n                courseId: courseId,   //\n                syllabusUrl: publicUrl //\n            }),\n        });\n\n        if (!response.ok) throw new Error(\"Syllabus Audit Failed\");\n        const aiResult = await response.json();\n\n        // FIX: Only update milestones, explicitly reset grade to 0\n        await db.update(courses)\n            .set({\n                milestones: aiResult.milestones, //\n                currentGrade: 0, // Prevents accidental 82% during syllabus phase\n            })\n            .where(eq(courses.id, courseId));\n\n        // FOR VAULT\n        // 2. NEW: Log the Syllabus in the submissions table so it shows in the Vault\n        await db.insert(submissions).values({\n            courseId: courseId,\n            name: \"Official Course Syllabus\",\n            // We store the URL in a JSON field if you want easy access later\n            analysisReport: [{ type: \"syllabus\", url: publicUrl }]\n        });\n\n        revalidatePath(`/course/${courseId}`);\n        return { success: true };\n    } catch (error) {\n        console.error(\"Syllabus Error:\", error);\n        return { success: false, error: \"Sync Failed\" };\n    }\n}\n\n/**\n * SUBMISSION AUTOMATION (The Performance)\n * Aligned with AnalysisRequest in api.py\n */\nexport async function createSubmissionAction(courseId: string, pdfUrl: string) {\n    try {\n        const backendBase = process.env.BACKEND_URL || \"http://127.0.0.1:8000\";\n\n        // 1. Fetch current context for the weighted grade calculation\n        const course = await db.query.courses.findFirst({\n            where: eq(courses.id, courseId)\n        });\n\n        // 2. Trigger Midterm Analysis\n        const response = await fetch(`${backendBase}/analyze-submission`, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({\n                submissionUrl: pdfUrl, //\n                existingMilestones: course?.milestones || [] //\n            }),\n        });\n\n        if (!response.ok) throw new Error(\"Neural Analysis fetch failed\");\n        const auditResults = await response.json();\n\n        // 3. Update the Course (This sets the 82% Grade)\n        // Maps Python 'updated_current_grade' to DB 'currentGrade'\n        await db.update(courses)\n            .set({\n                currentGrade: Math.round(auditResults.updated_current_grade || 0), // Schema is integer\n                milestones: auditResults.full_history, //\n            })\n            .where(eq(courses.id, courseId));\n\n        // 4. Create the Submission Record (Stores KCL/Diode tips)\n        // Maps Python 'analysis_report' to DB 'analysisReport'\n        const [newRecord] = await db.insert(submissions).values({\n            courseId: courseId,\n            name: `Audit: ${new Date().toLocaleDateString()}`,\n            analysisReport: auditResults.analysis_report,\n        }).returning({ id: submissions.id });\n\n        revalidatePath(`/course/${courseId}`);\n        revalidatePath('/');\n\n        return { id: newRecord.id, success: true };\n    } catch (error) {\n        console.error(\"Submission Action Failure:\", error);\n        return { success: false, error: \"Database or API sync error\" };\n    }\n}\n\n/**\n * DATA RESET & MAINTENANCE\n */\nexport async function deleteSyllabusAction(courseId: string) {\n    try {\n        await db.update(courses)\n            .set({\n                milestones: null,\n                currentGrade: 0\n            })\n            .where(eq(courses.id, courseId));\n\n        revalidatePath(`/course/${courseId}`);\n        return { success: true };\n    } catch (error) {\n        return { success: false, error: \"Failed to reset sector\" };\n    }\n}\n\nexport async function deleteSubmissionAction(submissionId: string, courseId: string) {\n    await db.delete(submissions).where(eq(submissions.id, submissionId));\n    revalidatePath(`/course/${courseId}`);\n}\n\nexport async function purgeCourseTelemetry(courseId: string) {\n    await db.update(courses)\n        .set({\n            milestones: null,\n            currentGrade: 0\n        })\n        .where(eq(courses.id, courseId));\n\n    revalidatePath(`/course/${courseId}`);\n}"],"names":[],"mappings":";;;;;;;MAUsB,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,gDAAA"}},
    {"offset": {"line": 21, "column": 0}, "map": {"version":3,"sources":["file:///Users/abby/Desktop/UofTHacks26/frontend/app/ui/AddCourseModal.tsx"],"sourcesContent":["// frontend/app/ui/AddCourseModal.tsx\n'use client';\n\nimport { motion, AnimatePresence } from 'motion/react';\nimport { X } from 'lucide-react';\nimport { createCourse } from '@/app/lib/actions';\n\ninterface AddCourseModalProps {\n    isOpen: boolean;\n    onClose: () => void;\n}\n\nexport default function AddCourseModal({ isOpen, onClose }: AddCourseModalProps) {\n    return (\n        <AnimatePresence>\n            {isOpen && (\n                <div className=\"fixed inset-0 z-[200] flex items-center justify-center p-4 bg-black/60 backdrop-blur-sm\">\n                    <motion.div\n                        initial={{ opacity: 0, scale: 0.9, y: 20 }}\n                        animate={{ opacity: 1, scale: 1, y: 0 }}\n                        exit={{ opacity: 0, scale: 0.9, y: 20 }}\n                        className=\"w-full max-w-md bg-[#00204E] border-2 border-[#8B5CF6]/50 rounded-[2.5rem] p-8 shadow-[0_0_50px_rgba(139,92,246,0.3)]\"\n                    >\n                        <div className=\"flex justify-between items-center mb-8\">\n                            <h2 className=\"text-2xl font-black text-white uppercase italic\">New Course</h2>\n                            <button onClick={onClose} className=\"text-white/40 hover:text-white\">\n                                <X className=\"w-6 h-6\" />\n                            </button>\n                        </div>\n\n                        <form action={async (formData) => {\n                            await createCourse(formData);\n                            onClose(); // Closes modal after server action completes\n                        }} className=\"space-y-6\">\n                            <div>\n                                <label className=\"text-[10px] font-black text-[#8B5CF6] uppercase tracking-[0.2em] mb-2 block\">Course Name</label>\n                                <input\n                                    name=\"courseName\"\n                                    placeholder=\"e.g. MAT223 Linear Algebra\"\n                                    required\n                                    autoFocus\n                                    className=\"w-full bg-white/5 border border-white/10 rounded-xl px-4 py-3 text-white outline-none focus:border-[#8B5CF6] transition-all\"\n                                />\n                            </div>\n                            <button type=\"submit\" className=\"w-full py-4 bg-gradient-to-r from-[#8B5CF6] to-[#10B981] text-white font-black uppercase tracking-widest rounded-xl hover:shadow-[0_0_30px_rgba(16,185,129,0.4)] transition-all\">\n                                Initialize Course\n                            </button>\n                        </form>\n                    </motion.div>\n                </div>\n            )}\n        </AnimatePresence>\n    );\n}"],"names":[],"mappings":";;;;;;;;;;;;;;;AAKA;AALA,qCAAqC;AACrC;;;;;AAWe,SAAS,eAAe,EAAE,MAAM,EAAE,OAAO,EAAuB;IAC3E,qBACI,6LAAC;kBACI,wBACG,6LAAC;YAAI,WAAU;sBACX,cAAA,6LAAC,OAAO,GAAG;gBACP,SAAS;oBAAE,SAAS;oBAAG,OAAO;oBAAK,GAAG;gBAAG;gBACzC,SAAS;oBAAE,SAAS;oBAAG,OAAO;oBAAG,GAAG;gBAAE;gBACtC,MAAM;oBAAE,SAAS;oBAAG,OAAO;oBAAK,GAAG;gBAAG;gBACtC,WAAU;;kCAEV,6LAAC;wBAAI,WAAU;;0CACX,6LAAC;gCAAG,WAAU;0CAAkD;;;;;;0CAChE,6LAAC;gCAAO,SAAS;gCAAS,WAAU;0CAChC,cAAA,6LAAC;oCAAE,WAAU;;;;;;;;;;;;;;;;;kCAIrB,6LAAC;wBAAK,QAAQ,OAAO;4BACjB,MAAM,IAAA,qKAAY,EAAC;4BACnB,WAAW,6CAA6C;wBAC5D;wBAAG,WAAU;;0CACT,6LAAC;;kDACG,6LAAC;wCAAM,WAAU;kDAA8E;;;;;;kDAC/F,6LAAC;wCACG,MAAK;wCACL,aAAY;wCACZ,QAAQ;wCACR,SAAS;wCACT,WAAU;;;;;;;;;;;;0CAGlB,6LAAC;gCAAO,MAAK;gCAAS,WAAU;0CAAkL;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAS9O;KAzCwB"}},
    {"offset": {"line": 173, "column": 0}, "map": {"version":3,"sources":["file:///Users/abby/Desktop/UofTHacks26/frontend/app/ui/AddCourseButton.tsx"],"sourcesContent":["'use client'; // This allows for interactive state\n\nimport { useState } from 'react';\nimport AddCourseModal from './AddCourseModal';\nimport { Plus } from 'lucide-react';\n\nexport function AddCourseButton() {\n    const [isOpen, setIsOpen] = useState(false);\n\n    return (\n        <>\n            <button\n                onClick={() => setIsOpen(true)}\n                className=\"flex items-center gap-2 px-6 py-3 bg-[#8B5CF6] text-white font-black uppercase tracking-widest rounded-2xl shadow-[0_0_20px_rgba(139,92,246,0.4)]\"\n            >\n                <Plus className=\"w-5 h-5\" />\n                Add Course\n            </button>\n\n            <AddCourseModal\n                isOpen={isOpen}\n                onClose={() => setIsOpen(false)}\n            />\n        </>\n    );\n}"],"names":[],"mappings":";;;;;AAEA;AACA;;;;;;;;AAHA,cAAc,oCAAoC;;;;AAM3C,SAAS;;IACZ,MAAM,CAAC,QAAQ,UAAU,GAAG,IAAA,yKAAQ,EAAC;IAErC,qBACI;;0BACI,6LAAC;gBACG,SAAS,IAAM,UAAU;gBACzB,WAAU;;kCAEV,6LAAC;wBAAK,WAAU;;;;;;oBAAY;;;;;;;0BAIhC,6LAAC,0IAAc;gBACX,QAAQ;gBACR,SAAS,IAAM,UAAU;;;;;;;;AAIzC;GAnBgB;KAAA"}},
    {"offset": {"line": 236, "column": 0}, "map": {"version":3,"sources":["file:///Users/abby/Desktop/UofTHacks26/frontend/app/lib/actions.tsx"],"sourcesContent":["'use server'\n\nimport { db } from '../../drizzle/index';\nimport { courses, submissions } from '../../drizzle/db/schema';\nimport { eq } from 'drizzle-orm';\nimport { revalidatePath } from 'next/cache';\n\n/**\n * COURSE MANAGEMENT\n */\nexport async function createCourse(formData: FormData) {\n    const name = formData.get('courseName') as string;\n    await db.insert(courses).values({\n        name: name,\n        description: \"Course initialized for audit.\",\n        currentGrade: 0,\n        milestones: [],\n    });\n    revalidatePath('/');\n}\n\nexport async function deleteCourse(courseId: string) {\n    try {\n        await db.delete(courses).where(eq(courses.id, courseId));\n        revalidatePath('/');\n        return { success: true };\n    } catch (error) {\n        return { success: false };\n    }\n}\n\n/**\n * SYLLABUS AUTOMATION (The Roadmap)\n * Aligned with SyllabusRequest in api.py\n */\nexport async function processSyllabusAction(courseId: string, publicUrl: string) {\n    try {\n        const backendBase = process.env.BACKEND_URL || \"http://127.0.0.1:8000\";\n\n        const response = await fetch(`${backendBase}/process-syllabus`, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({\n                courseId: courseId,   //\n                syllabusUrl: publicUrl //\n            }),\n        });\n\n        if (!response.ok) throw new Error(\"Syllabus Audit Failed\");\n        const aiResult = await response.json();\n\n        // FIX: Only update milestones, explicitly reset grade to 0\n        await db.update(courses)\n            .set({\n                milestones: aiResult.milestones, //\n                currentGrade: 0, // Prevents accidental 82% during syllabus phase\n            })\n            .where(eq(courses.id, courseId));\n\n        // FOR VAULT\n        // 2. NEW: Log the Syllabus in the submissions table so it shows in the Vault\n        await db.insert(submissions).values({\n            courseId: courseId,\n            name: \"Official Course Syllabus\",\n            // We store the URL in a JSON field if you want easy access later\n            analysisReport: [{ type: \"syllabus\", url: publicUrl }]\n        });\n\n        revalidatePath(`/course/${courseId}`);\n        return { success: true };\n    } catch (error) {\n        console.error(\"Syllabus Error:\", error);\n        return { success: false, error: \"Sync Failed\" };\n    }\n}\n\n/**\n * SUBMISSION AUTOMATION (The Performance)\n * Aligned with AnalysisRequest in api.py\n */\nexport async function createSubmissionAction(courseId: string, pdfUrl: string) {\n    try {\n        const backendBase = process.env.BACKEND_URL || \"http://127.0.0.1:8000\";\n\n        // 1. Fetch current context for the weighted grade calculation\n        const course = await db.query.courses.findFirst({\n            where: eq(courses.id, courseId)\n        });\n\n        // 2. Trigger Midterm Analysis\n        const response = await fetch(`${backendBase}/analyze-submission`, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({\n                submissionUrl: pdfUrl, //\n                existingMilestones: course?.milestones || [] //\n            }),\n        });\n\n        if (!response.ok) throw new Error(\"Neural Analysis fetch failed\");\n        const auditResults = await response.json();\n\n        // 3. Update the Course (This sets the 82% Grade)\n        // Maps Python 'updated_current_grade' to DB 'currentGrade'\n        await db.update(courses)\n            .set({\n                currentGrade: Math.round(auditResults.updated_current_grade || 0), // Schema is integer\n                milestones: auditResults.full_history, //\n            })\n            .where(eq(courses.id, courseId));\n\n        // 4. Create the Submission Record (Stores KCL/Diode tips)\n        // Maps Python 'analysis_report' to DB 'analysisReport'\n        const [newRecord] = await db.insert(submissions).values({\n            courseId: courseId,\n            name: `Audit: ${new Date().toLocaleDateString()}`,\n            analysisReport: auditResults.analysis_report,\n        }).returning({ id: submissions.id });\n\n        revalidatePath(`/course/${courseId}`);\n        revalidatePath('/');\n\n        return { id: newRecord.id, success: true };\n    } catch (error) {\n        console.error(\"Submission Action Failure:\", error);\n        return { success: false, error: \"Database or API sync error\" };\n    }\n}\n\n/**\n * DATA RESET & MAINTENANCE\n */\nexport async function deleteSyllabusAction(courseId: string) {\n    try {\n        await db.update(courses)\n            .set({\n                milestones: null,\n                currentGrade: 0\n            })\n            .where(eq(courses.id, courseId));\n\n        revalidatePath(`/course/${courseId}`);\n        return { success: true };\n    } catch (error) {\n        return { success: false, error: \"Failed to reset sector\" };\n    }\n}\n\nexport async function deleteSubmissionAction(submissionId: string, courseId: string) {\n    await db.delete(submissions).where(eq(submissions.id, submissionId));\n    revalidatePath(`/course/${courseId}`);\n}\n\nexport async function purgeCourseTelemetry(courseId: string) {\n    await db.update(courses)\n        .set({\n            milestones: null,\n            currentGrade: 0\n        })\n        .where(eq(courses.id, courseId));\n\n    revalidatePath(`/course/${courseId}`);\n}"],"names":[],"mappings":";;;;;;;MAqBsB,wBAAA,WAAA,GAAA,IAAA,kPAAA,EAAA,8CAAA,uOAAA,EAAA,KAAA,GAAA,6OAAA,EAAA,gDAAA"}},
    {"offset": {"line": 253, "column": 0}, "map": {"version":3,"sources":["file:///Users/abby/Desktop/UofTHacks26/frontend/app/ui/DeleteCourseBtn.tsx"],"sourcesContent":["'use client';\n\nimport { Trash2, Loader2 } from 'lucide-react';\nimport { deleteCourse } from '@/app/lib/actions';\nimport { useTransition } from 'react';\nimport { useRouter } from 'next/navigation';\n\nexport function DeleteCourseBtn({ courseId }: { courseId: string }) {\n    const [isPending, startTransition] = useTransition();\n    const router = useRouter();\n\n    const handlePurge = async (e: React.MouseEvent) => {\n        // These are crucial to prevent the Link from firing\n        e.preventDefault();\n        e.stopPropagation();\n\n        if (!window.confirm(\"Purge this identity from the Nexus?\")) return;\n\n        // This proves the button is receiving the click\n        console.log(\"PURGE BUTTON: Captured click for ID\", courseId);\n\n        startTransition(async () => {\n            try {\n                const result = await deleteCourse(courseId);\n                if (result?.success) {\n                    router.refresh(); // Refresh the Server Component grid\n                }\n            } catch (err) {\n                console.error(\"PURGE ERROR:\", err);\n            }\n        });\n    };\n\n    return (\n        <button\n            type=\"button\"\n            disabled={isPending}\n            onClick={handlePurge}\n            // pointer-events-auto ensures this button stays clickable \n            // even if something else is trying to cover it.\n            className={`p-2.5 rounded-xl border transition-all pointer-events-auto relative shadow-2xl ${isPending\n                ? 'bg-rose-500/50 cursor-not-allowed opacity-100'\n                : 'bg-[#020617] border-rose-500/30 text-rose-500 hover:bg-rose-500 hover:text-white active:scale-95'\n                }`}\n        >\n            {isPending ? <Loader2 className=\"w-4 h-4 animate-spin\" /> : <Trash2 className=\"w-4 h-4\" />}\n        </button>\n    );\n}"],"names":[],"mappings":";;;;;;;;;;AAGA;AACA;AACA;;;AALA;;;;;AAOO,SAAS,gBAAgB,EAAE,QAAQ,EAAwB;;IAC9D,MAAM,CAAC,WAAW,gBAAgB,GAAG,IAAA,8KAAa;IAClD,MAAM,SAAS,IAAA,kJAAS;IAExB,MAAM,cAAc,OAAO;QACvB,oDAAoD;QACpD,EAAE,cAAc;QAChB,EAAE,eAAe;QAEjB,IAAI,CAAC,OAAO,OAAO,CAAC,wCAAwC;QAE5D,gDAAgD;QAChD,QAAQ,GAAG,CAAC,uCAAuC;QAEnD,gBAAgB;YACZ,IAAI;gBACA,MAAM,SAAS,MAAM,IAAA,qKAAY,EAAC;gBAClC,IAAI,QAAQ,SAAS;oBACjB,OAAO,OAAO,IAAI,oCAAoC;gBAC1D;YACJ,EAAE,OAAO,KAAK;gBACV,QAAQ,KAAK,CAAC,gBAAgB;YAClC;QACJ;IACJ;IAEA,qBACI,6LAAC;QACG,MAAK;QACL,UAAU;QACV,SAAS;QACT,2DAA2D;QAC3D,gDAAgD;QAChD,WAAW,CAAC,+EAA+E,EAAE,YACvF,kDACA,oGACA;kBAEL,0BAAY,6LAAC;YAAQ,WAAU;;;;;iCAA4B,6LAAC;YAAO,WAAU;;;;;;;;;;;AAG1F;GAzCgB;;QACyB,8KAAa;QACnC,kJAAS;;;KAFZ"}},
    {"offset": {"line": 337, "column": 0}, "map": {"version":3,"sources":["file:///Users/abby/Desktop/UofTHacks26/frontend/node_modules/next/src/build/webpack/loaders/next-flight-loader/action-client-wrapper.ts"],"sourcesContent":["// This file must be bundled in the app's client layer, it shouldn't be directly\n// imported by the server.\n\nexport { callServer } from 'next/dist/client/app-call-server'\nexport { findSourceMapURL } from 'next/dist/client/app-find-source-map-url'\n\n// A noop wrapper to let the Flight client create the server reference.\n// See also: https://github.com/facebook/react/pull/26632\n// eslint-disable-next-line import/no-extraneous-dependencies\nexport { createServerReference } from 'react-server-dom-webpack/client'\n"],"names":["callServer","createServerReference","findSourceMapURL"],"mappings":"AAAA,gFAAgF;AAChF,0BAA0B;;;;;;;;;;;;;;;;IAEjBA,UAAU,EAAA;eAAVA,eAAAA,UAAU;;IAMVC,qBAAqB,EAAA;eAArBA,QAAAA,qBAAqB;;IALrBC,gBAAgB,EAAA;eAAhBA,qBAAAA,gBAAgB;;;+BADE;qCACM;wBAKK","ignoreList":[0]}}]
}