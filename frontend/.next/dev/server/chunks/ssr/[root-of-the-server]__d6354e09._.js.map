{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///Users/abby/Desktop/UofTHacks26/frontend/drizzle/db/schema.ts"],"sourcesContent":["// frontend/drizzle/db/schema.ts\nimport { pgTable, uuid, text, integer, timestamp, jsonb } from \"drizzle-orm/pg-core\";\n\nexport const courses = pgTable(\"courses\", {\n    id: uuid(\"id\").defaultRandom().primaryKey(),\n    name: text(\"name\").notNull(),\n    description: text(\"description\"),\n    // Stores the AI-calculated overall average\n    currentGrade: integer(\"current_grade\").default(0),\n    // Stores the syllabus weights (e.g., [{\"name\": \"Midterm\", \"weight\": 20, \"score\": 85}])\n    milestones: jsonb(\"milestones\").default([]),\n    createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n\nexport const submissions = pgTable(\"submissions\", {\n    id: uuid(\"id\").defaultRandom().primaryKey(),\n    courseId: uuid(\"course_id\").references(() => courses.id, { onDelete: 'cascade' }),\n    name: text(\"name\").notNull(),\n    // Stores the detailed error analysis\n    analysisReport: jsonb(\"analysis_report\").default([]),\n    createdAt: timestamp(\"created_at\").defaultNow().notNull(),\n});\n"],"names":[],"mappings":";;;;;;AAAA,gCAAgC;AAChC;AAAA;AAAA;AAAA;AAAA;AAAA;;AAEO,MAAM,UAAU,IAAA,gKAAO,EAAC,WAAW;IACtC,IAAI,IAAA,uKAAI,EAAC,MAAM,aAAa,GAAG,UAAU;IACzC,MAAM,IAAA,uKAAI,EAAC,QAAQ,OAAO;IAC1B,aAAa,IAAA,uKAAI,EAAC;IAClB,2CAA2C;IAC3C,cAAc,IAAA,6KAAO,EAAC,iBAAiB,OAAO,CAAC;IAC/C,uFAAuF;IACvF,YAAY,IAAA,yKAAK,EAAC,cAAc,OAAO,CAAC,EAAE;IAC1C,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;AAC3D;AAEO,MAAM,cAAc,IAAA,gKAAO,EAAC,eAAe;IAC9C,IAAI,IAAA,uKAAI,EAAC,MAAM,aAAa,GAAG,UAAU;IACzC,UAAU,IAAA,uKAAI,EAAC,aAAa,UAAU,CAAC,IAAM,QAAQ,EAAE,EAAE;QAAE,UAAU;IAAU;IAC/E,MAAM,IAAA,uKAAI,EAAC,QAAQ,OAAO;IAC1B,qCAAqC;IACrC,gBAAgB,IAAA,yKAAK,EAAC,mBAAmB,OAAO,CAAC,EAAE;IACnD,WAAW,IAAA,iLAAS,EAAC,cAAc,UAAU,GAAG,OAAO;AAC3D"}},
    {"offset": {"line": 84, "column": 0}, "map": {"version":3,"sources":["file:///Users/abby/Desktop/UofTHacks26/frontend/drizzle/index.ts"],"sourcesContent":["// frontend/lib/db/index.ts\nimport { drizzle } from 'drizzle-orm/postgres-js';\nimport postgres from 'postgres';\nimport * as schema from './db/schema'; // Import everything from your schema file\n\nconst connectionString = process.env.DATABASE_URL!;\nconst client = postgres(connectionString);\n\n// Pass the schema here! This is what fixes the \"Property courses does not exist\" error.\nexport const db = drizzle(client, { schema });\n"],"names":[],"mappings":";;;;AAAA,2BAA2B;AAC3B;AACA;AACA,gNAAuC,0CAA0C;;;;AAEjF,MAAM,mBAAmB,QAAQ,GAAG,CAAC,YAAY;AACjD,MAAM,SAAS,IAAA,mJAAQ,EAAC;AAGjB,MAAM,KAAK,IAAA,qKAAO,EAAC,QAAQ;IAAE,QAAA;AAAO"}},
    {"offset": {"line": 104, "column": 0}, "map": {"version":3,"sources":["file:///Users/abby/Desktop/UofTHacks26/frontend/app/lib/actions.tsx"],"sourcesContent":["'use server'\n\nimport { db } from '../../drizzle/index';\nimport { courses, submissions } from '../../drizzle/db/schema';\nimport { eq } from 'drizzle-orm';\nimport { revalidatePath } from 'next/cache';\n\n/**\n * COURSE MANAGEMENT\n */\nexport async function createCourse(formData: FormData) {\n    const name = formData.get('courseName') as string;\n    await db.insert(courses).values({\n        name: name,\n        description: \"Course initialized for audit.\",\n        currentGrade: 0,\n        milestones: [],\n    });\n    revalidatePath('/');\n}\n\nexport async function deleteCourse(courseId: string) {\n    try {\n        await db.delete(courses).where(eq(courses.id, courseId));\n        revalidatePath('/');\n        return { success: true };\n    } catch (error) {\n        return { success: false };\n    }\n}\n\n/**\n * SYLLABUS AUTOMATION (The Roadmap)\n * Aligned with SyllabusRequest in api.py\n */\nexport async function processSyllabusAction(courseId: string, publicUrl: string) {\n    try {\n        const backendBase = process.env.BACKEND_URL || \"http://127.0.0.1:8000\";\n\n        const response = await fetch(`${backendBase}/process-syllabus`, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({\n                courseId: courseId,   //\n                syllabusUrl: publicUrl //\n            }),\n        });\n\n        if (!response.ok) throw new Error(\"Syllabus Audit Failed\");\n        const aiResult = await response.json();\n\n        // FIX: Only update milestones, explicitly reset grade to 0\n        await db.update(courses)\n            .set({\n                milestones: aiResult.milestones, //\n                currentGrade: 0, // Prevents accidental 82% during syllabus phase\n            })\n            .where(eq(courses.id, courseId));\n\n        // FOR VAULT\n        // 2. NEW: Log the Syllabus in the submissions table so it shows in the Vault\n        await db.insert(submissions).values({\n            courseId: courseId,\n            name: \"Official Course Syllabus\",\n            // We store the URL in a JSON field if you want easy access later\n            analysisReport: [{ type: \"syllabus\", url: publicUrl }]\n        });\n\n        revalidatePath(`/course/${courseId}`);\n        return { success: true };\n    } catch (error) {\n        console.error(\"Syllabus Error:\", error);\n        return { success: false, error: \"Sync Failed\" };\n    }\n}\n\n/**\n * SUBMISSION AUTOMATION (The Performance)\n * Aligned with AnalysisRequest in api.py\n */\nexport async function createSubmissionAction(courseId: string, pdfUrl: string) {\n    try {\n        const backendBase = process.env.BACKEND_URL || \"http://127.0.0.1:8000\";\n\n        // 1. Fetch current context for the weighted grade calculation\n        const course = await db.query.courses.findFirst({\n            where: eq(courses.id, courseId)\n        });\n\n        // 2. Trigger Midterm Analysis\n        const response = await fetch(`${backendBase}/analyze-submission`, {\n            method: 'POST',\n            headers: { 'Content-Type': 'application/json' },\n            body: JSON.stringify({\n                submissionUrl: pdfUrl, //\n                existingMilestones: course?.milestones || [] //\n            }),\n        });\n\n        if (!response.ok) throw new Error(\"Neural Analysis fetch failed\");\n        const auditResults = await response.json();\n\n        // 3. Update the Course (This sets the 82% Grade)\n        // Maps Python 'updated_current_grade' to DB 'currentGrade'\n        await db.update(courses)\n            .set({\n                currentGrade: Math.round(auditResults.updated_current_grade || 0), // Schema is integer\n                milestones: auditResults.full_history, //\n            })\n            .where(eq(courses.id, courseId));\n\n        // 4. Create the Submission Record (Stores KCL/Diode tips)\n        // Maps Python 'analysis_report' to DB 'analysisReport'\n        const [newRecord] = await db.insert(submissions).values({\n            courseId: courseId,\n            name: `Audit: ${new Date().toLocaleDateString()}`,\n            analysisReport: auditResults.analysis_report,\n        }).returning({ id: submissions.id });\n\n        revalidatePath(`/course/${courseId}`);\n        revalidatePath('/');\n\n        return { id: newRecord.id, success: true };\n    } catch (error) {\n        console.error(\"Submission Action Failure:\", error);\n        return { success: false, error: \"Database or API sync error\" };\n    }\n}\n\n/**\n * DATA RESET & MAINTENANCE\n */\nexport async function deleteSyllabusAction(courseId: string) {\n    try {\n        await db.update(courses)\n            .set({\n                milestones: null,\n                currentGrade: 0\n            })\n            .where(eq(courses.id, courseId));\n\n        revalidatePath(`/course/${courseId}`);\n        return { success: true };\n    } catch (error) {\n        return { success: false, error: \"Failed to reset sector\" };\n    }\n}\n\nexport async function deleteSubmissionAction(submissionId: string, courseId: string) {\n    await db.delete(submissions).where(eq(submissions.id, submissionId));\n    revalidatePath(`/course/${courseId}`);\n}\n\nexport async function purgeCourseTelemetry(courseId: string) {\n    await db.update(courses)\n        .set({\n            milestones: null,\n            currentGrade: 0\n        })\n        .where(eq(courses.id, courseId));\n\n    revalidatePath(`/course/${courseId}`);\n}"],"names":[],"mappings":"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"}},
    {"offset": {"line": 297, "column": 0}, "map": {"version":3,"sources":["file:///Users/abby/Desktop/UofTHacks26/frontend/.next-internal/server/app/page/actions.js%20%28server%20actions%20loader%29"],"sourcesContent":["export {deleteCourse as '40ccc0a3956a500315848a9343d415371d73d4dcf2'} from 'ACTIONS_MODULE0'\nexport {createCourse as '4090343f00ed10f4472b943068f07dc92ce7b193bd'} from 'ACTIONS_MODULE0'\n"],"names":[],"mappings":";AAAA"}}]
}